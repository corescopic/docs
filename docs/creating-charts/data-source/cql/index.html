<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<title data-react-helmet="true">CQL | corescopic Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.corescopic.com/docs/creating-charts/data-source/cql"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="CQL | corescopic Documentation"><meta data-react-helmet="true" name="description" content="Under the hood, corescopic uses the corescopic Query Language (CQL) to fetch chart data and create statistics. CQL is written in JSON but most of its terminology is based on SQL&#x27;s namings. Having a robust understanding of SQL will help getting started with CQL quickly."><meta data-react-helmet="true" property="og:description" content="Under the hood, corescopic uses the corescopic Query Language (CQL) to fetch chart data and create statistics. CQL is written in JSON but most of its terminology is based on SQL&#x27;s namings. Having a robust understanding of SQL will help getting started with CQL quickly."><link data-react-helmet="true" rel="icon" href="/img/logo.png"><link data-react-helmet="true" rel="canonical" href="https://docs.corescopic.com/docs/creating-charts/data-source/cql"><link data-react-helmet="true" rel="alternate" href="https://docs.corescopic.com/docs/creating-charts/data-source/cql" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.corescopic.com/docs/creating-charts/data-source/cql" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ef5031ab.css">
<link rel="preload" href="/assets/js/runtime~main.fed0ffe3.js" as="script">
<link rel="preload" href="/assets/js/main.c9ccc2a9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="corescopic logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.png" alt="corescopic logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">corescopic Documentation</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://corescopic.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Homepage<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Getting started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/tracking-code/implementation">Tracking Code</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/creating-charts/chart-types">Creating Charts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/creating-charts/chart-types">Chart Types</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/docs/creating-charts/data-source/configuration">Data Source</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/creating-charts/data-source/configuration">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/creating-charts/data-source/cql">CQL</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/creating-charts/post-processing">Post Processing</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CQL</h1></header><p>Under the hood, corescopic uses the corescopic Query Language (CQL) to fetch chart data and create statistics. CQL is written in JSON but most of its terminology is based on SQL&#x27;s namings. Having a robust understanding of SQL will help getting started with CQL quickly.</p><p>CQL is built to provide a better experience creating statistics by adding small abstractions over SQL, allowing the query to be easily parsed and displayed by the chart creator and allowing it to be easily verified by our backend. Internally CQL queries will be transpiled into SQL queries to be run against the events database so all rules of SQL also apply to CQL queries.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="structure">Structure<a aria-hidden="true" class="hash-link" href="#structure" title="Direct link to heading">â€‹</a></h2><p>CQL is a JSON object that conatins various values to specify what data to fetch. At its minimum, a CQL query contains an <code>exports</code> array with columns to fetch and a <code>where</code> array:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;exports&quot;: [&quot;events.name&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;where&quot;: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="column-names">Column Names<a aria-hidden="true" class="hash-link" href="#column-names" title="Direct link to heading">â€‹</a></h3><p>Column names are used throughout CQL, e.g. when exporting columns, using where clauses or grouping rows.</p><p>The names always follow the format of <code>tableName.columnNameOrModifier[.subColumnorModifier[.submodifier]]</code>. Valid table names are <code>events</code> for the list of events and <code>sessions</code> for the list of all sessions.</p><p>Next a column name or modifier must be added. Examples for this is <code>events.name</code> to get the event name, <code>events.count</code> to count the number of events or <code>sessions.user_id</code> to get the user ID of a session.</p><p>The <code>events</code> table contains the following columns and modifiers:</p><ul><li><code>events.name</code>: Name of the event</li><li><code>events.tracker_id</code>: Tracker ID used for the event</li><li><code>events.session_id</code>: Connected session ID. This might be -1 if collected in unconsented mode</li><li><code>events.user_id</code>: Connected user ID. This might be -1 if collected in unconsented mode</li><li><code>events.timestamp</code>: Time of the event</li><li><code>events.count</code>: Number of events</li></ul><p>Any additional data you provided when adding the event can be accessed using <code>events.contents.[name]</code>, e.g. <code>events.contents.shop_username</code> if you provided a <code>shop_username</code> parameter.
Contents can be modified by using the submodifier: E.g. using <code>events.contents.purchase_value.sum</code> to sum all values or <code>events.contents.purchase_value.count</code> to count the number of items with the specific property.</p><p>The <code>sessions</code> table contains the following columns and modifiers:</p><ul><li><code>sessions.id</code>: ID of the session</li><li><code>sessions.user_id</code>: Connected user ID</li><li><code>sessions.isBounce</code>: <code>true</code> if the user has bounced</li><li><code>sessions.user_agent</code>: Last known user agent of the user</li><li><code>sessions.created_at</code>: Time that the session was first created</li><li><code>sessions.updated_at</code>: Time that the session was last modified</li><li><code>sessions.count</code>: Number of sessions</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="exports">exports<a aria-hidden="true" class="hash-link" href="#exports" title="Direct link to heading">â€‹</a></h2><p>Exports are columns that should be returned by the statement, similar to SQL&#x27;s <code>SELECT</code> items. The array should contain at least one <a href="#column-name">column name</a>, otherwise the query will be regarded as invalid.</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;exports&quot;: [&quot;events.name&quot;, &quot;sessions.user_agent&quot;],</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>When using both events and sessions, session details will automatically be <code>LEFT JOIN</code>ed with event details so both tables can be used easily.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="where">where<a aria-hidden="true" class="hash-link" href="#where" title="Direct link to heading">â€‹</a></h2><p>The <code>where</code> array provides conditions for selecting rows, just like SQL <code>WHERE</code>. Each item in the where array can be another sub-array to group conditions or a where clause object.</p><p>This is what the <code>where</code> array might look like:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;where&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;time&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;BETWEEN&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;column&quot;: &quot;events.timestamp&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;value&quot;: &quot;2021-01-01 00:00:00&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;value2&quot;: &quot;NOW - 1m&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;AND&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;value&quot;: &quot;purchase&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;clause&quot;: &quot;connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;OR&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;value&quot;: &quot;lead&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This will select all rows that occured between 01/01/2020 and 7 days ago and where the <code>events.name</code> is <code>purchase</code> or <code>lead</code>. When using SQL, this could be translated into</p><div class="codeBlockContainer_J+bg language-SQL"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">WHERE </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  events.timestamp &lt; DateAdd(DD,-7,GETDATE()) AND events.timestamp &gt; 2021-01-01 00-00-00 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    events.name = &#x27;purchase&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    events.name = &#x27;lead&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="connection-clauses">Connection Clauses<a aria-hidden="true" class="hash-link" href="#connection-clauses" title="Direct link to heading">â€‹</a></h3><p>CQL supports different comparison clauses (compare, time with different types each) but all comparisons need to be connected using a connection clause (AND or OR).</p><p>For example, this CQL snippet is invalid because there are two comparison clauses in sequence without a connection clause:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;where&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;value&quot;: &quot;purchase&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;value&quot;: &quot;lead&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This CQL Snippet is valid as there is a connecting <code>OR</code> between both comparisons:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;where&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;value&quot;: &quot;purchase&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;OR&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;value&quot;: &quot;lead&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A connection clause should always have <code>&quot;clause&quot;: &quot;connection&quot;</code> and can have a <code>type</code> of <code>AND</code> or <code>OR</code>.</p><p>OR-Connection:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;clause&quot;: &quot;connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;OR&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>AND-Connection:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;clause&quot;: &quot;connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;AND&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="compare-clause">Compare clause<a aria-hidden="true" class="hash-link" href="#compare-clause" title="Direct link to heading">â€‹</a></h3><p>Compare clauses can be used for normal value comparisons. Those clauses should always have <code>&quot;clause&quot;: &quot;compare&quot;</code> and can have a <code>type</code> of &quot;GREATER&quot;,Â &quot;GREATER_EQUAL&quot;,Â &quot;SMALLER&quot;,Â &quot;SMALLER_EQUAL&quot;, &quot;EQUAL&quot; or &quot;NOT_EQUAL&quot;.</p><p>When comparing timestamps, it is advices to use <a href="#time-clause">Time clauses</a> instead as those are specialized to make working with time comparison easier.</p><p>A compare clause should also always have a <code>column</code>, which is the column name that should be compared against, and a <code>value</code> which is the value to compare to.</p><p>Equal-comparison:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;value&quot;: &quot;lead&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Greater-comparison:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;GREATER&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;column&quot;: &quot;events.contents.value&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;value&quot;: &quot;100&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="time-clause">Time clause<a aria-hidden="true" class="hash-link" href="#time-clause" title="Direct link to heading">â€‹</a></h3><p>Time clause should be used when handling comparisons of timestamps. While it is possible to use normal compare clauses, time clauses provide an additional abstraction over the raw timestamp data.</p><p>The clauses should always have <code>&quot;clause&quot;: &quot;time&quot;</code> and can have a <code>type</code> of &quot;BEFORE&quot;, &quot;AFTER&quot;, &quot;ON&quot; orÂ &quot;BETWEEN&quot; corresponding to &quot;SMALLER&quot;, &quot;GREATER&quot;, &quot;EQUAL&quot; and &quot;BETWEEN&quot; respectively.</p><p>As with compare clauses, time clauses should contain a <code>column</code> to compare and at least a <code>value</code> to compare against (see <a href="#time-values">time values</a>).</p><p>For example, only get rows before 01/01/2022:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;clause&quot;: &quot;time&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;BEFORE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;column&quot;: &quot;events.timestamp&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;value&quot;: &quot;2022-01-01 00:00:00&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Only get rows from the last 7 days:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;clause&quot;: &quot;time&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;AFTER&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;column&quot;: &quot;events.timestamp&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;value&quot;: &quot;NOW - 7d&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A special case is the <code>BETWEEN</code> clause as it takes two time values: A lower and a upper limit. The lower limit should be provided using <code>value</code> but the upper limit should be provided via <code>value2</code>.</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;clause&quot;: &quot;time&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;BETWEEN&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;column&quot;: &quot;events.timestamp&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;value&quot;: &quot;2021-01-02 00:00:00&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;value2&quot;: &quot;NOW + 7d&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="time-values">Time values<a aria-hidden="true" class="hash-link" href="#time-values" title="Direct link to heading">â€‹</a></h4><p>The value can be provided in two formats: absolute or relative. </p><p>An absolute time value describes a point in time that will not change, regardless of when the query has been executed. Absolute time values should have the format <code>YYYY-MM-DD HH:MM:SS</code>, e.g. <code>2021-01-01 00:00:00</code>.</p><p>Relative time values describe values relative to the time the query is executed. This could be used to always return the events of the last 30 days instead of having to update the absolute value manually each time. A relative value mus start with the keyword <code>NOW</code> to indicate it being relative to the current time. After that, any subtraction or addition might be performed to get a time.</p><p>For example, to get the time 7 days in the past, use <code>NOW + 7d</code>. To get the time 23 hours in the past you might use <code>NOW - 23h</code> or use <code>NOW - 1d + 1h</code>.</p><p>Please note that whitespaces are ignored in relative time values, resulting in <code>NOW+7d</code>, <code>NOW + 7 d</code>, <code>NOW  +   7d</code> and <code>NOW+ 7  d</code> all being valid values.</p><p>Valid units are:</p><ul><li>ms: Milliseconds</li><li>s: seconds</li><li>m: Minutes</li><li>h: Hours</li><li>d: Days</li><li>w: Weeks</li><li>M: Months</li><li>y: Years</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="groups">Groups<a aria-hidden="true" class="hash-link" href="#groups" title="Direct link to heading">â€‹</a></h3><p>Groups allow grouping multiple clauses together, like using parenthesis in SQL. CQL also allows multi-level nesting so your groups can contain sub-groups, which can also contain sub-groups etc..</p><p>Groups are indicated by using a sub-array in the main <code>where</code> array.</p><p>Groups are treated like normal compare clauses so groups must be connected to other clauses by using connection clauses.</p><p>While not being very useful, this snippet shows an example of multi-level grouping:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;where&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // No group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;value&quot;: &quot;not grouped&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Connection clause is needed here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;clause&quot;: &quot;connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;OR&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Start first group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;value&quot;: &quot;one&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Connection clause is needed here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;clause&quot;: &quot;connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;OR&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Start sub-group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value&quot;: &quot;two&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;clause&quot;: &quot;connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;type&quot;: &quot;OR&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value&quot;: &quot;three&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This example can be compared to this SQL code:</p><div class="codeBlockContainer_J+bg language-SQL"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">WHERE </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  events.name = &#x27;not grouped&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  OR </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    events.name = &#x27;one&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      events.name = &#x27;two&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      OR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      events.name = &#x27;three&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="examples">Examples<a aria-hidden="true" class="hash-link" href="#examples" title="Direct link to heading">â€‹</a></h2><h2 class="anchor anchorWithStickyNavbar_y2LR" id="examples-1">Examples<a aria-hidden="true" class="hash-link" href="#examples-1" title="Direct link to heading">â€‹</a></h2><ol><li>Selecting Event in the last 30 minutes that have a name of &quot;purchase&quot; or a value &gt; 0</li></ol><div class="codeBlockContainer_J+bg language-json"><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;exports&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;events.name&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events.contents.amount&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events.contents.orderId&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events.count&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;where&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TIME&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;mode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;relative&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;column&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;event.timestamp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;from&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;NOW - 30m&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;to&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;NOW&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AND&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EQUAL&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;column&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;event.name&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;purchase&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OR&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;GREATER&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;column&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;event.contents.amount&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This is comparable to this SQL Query:</p><div class="codeBlockContainer_J+bg language-SQL"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  events.name, events.contents.amount, events.contents.orderId, count(events.*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  events.timestamp &gt;= ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  events.timestamp &lt;= ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    events.name = &quot;purchase&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    events.contents.amount &gt; 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>Selecting sessions that have been created aftert 02.01.2021 but before 7 days ago</li></ol><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;exports&quot;: [&quot;sessions.id&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;where&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;clause&quot;: &quot;time&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;type&quot;: &quot;BETWEEN&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;column&quot;: &quot;sessions.created_at&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value&quot;: &quot;2021-01-02 00:00:00&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value2&quot;: &quot;NOW - 7d&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>Select event names and user agents with session ids</li></ol><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;exports&quot;: [&quot;events.name&quot;, &quot;events.contents.user_agent&quot;, &quot;session.id&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;where&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;value&quot;: &quot;pageview&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Please note that this requires a table join and you can access the session ID the events table, too. This results in this query returning the same results but with a better performance:</p><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;exports&quot;: [&quot;events.name&quot;, &quot;events.contents.user_agent&quot;, &quot;events.session_id&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;where&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;EQUAL&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;column&quot;: &quot;events.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;value&quot;: &quot;pageview&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="4"><li>Get the total number of events</li></ol><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;exports&quot;: [&quot;events.count&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;where&quot;: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="5"><li>Sum the total value of all events with a value greater 0</li></ol><div class="codeBlockContainer_J+bg language-JSON"><div class="codeBlockContent_csEI JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;exports&quot;: [&quot;events.contents.value.sum&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;where&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;clause&quot;: &quot;compare&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;type&quot;: &quot;GREATER&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;column&quot;: &quot;events.contents.value&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value&quot;: &quot;0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/corescopic/docs/edit/main/website/docs/creating-charts/data-source/cql.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/creating-charts/data-source/configuration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Configuration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/creating-charts/post-processing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Post Processing<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#structure" class="table-of-contents__link toc-highlight">Structure</a><ul><li><a href="#column-names" class="table-of-contents__link toc-highlight">Column Names</a></li></ul></li><li><a href="#exports" class="table-of-contents__link toc-highlight">exports</a></li><li><a href="#where" class="table-of-contents__link toc-highlight">where</a><ul><li><a href="#connection-clauses" class="table-of-contents__link toc-highlight">Connection Clauses</a></li><li><a href="#compare-clause" class="table-of-contents__link toc-highlight">Compare clause</a></li><li><a href="#time-clause" class="table-of-contents__link toc-highlight">Time clause</a></li><li><a href="#groups" class="table-of-contents__link toc-highlight">Groups</a></li></ul></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li><li><a href="#examples-1" class="table-of-contents__link toc-highlight">Examples</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://corescopic.com/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Imprint<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://corescopic.com/privacy-policy" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 corescopic Team. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fed0ffe3.js"></script>
<script src="/assets/js/main.c9ccc2a9.js"></script>
</body>
</html>